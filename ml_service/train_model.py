import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestRegressor
from sklearn.preprocessing import StandardScaler, OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.metrics import mean_squared_error, r2_score
import joblib
import io
import numpy as np

# Synthetic CSV data provided by the user
csv_data = """Rock_Type,Date,Rainfall,Slope_Angle,NDVI,Change_in_NDVI,Soil_Moisture,Blast_Vibration,Seismic_Vibration
Igneous,2023-01-12,13.78,26.4,0.62,-0.02,29.28,0.064,0.033
Igneous,2025-05-06,22.7,22.56,0.3,-0.047,24.69,0.286,0.01
Metamorphic,2021-01-23,40.24,27.37,0.62,-0.005,21.11,0.033,0.037
Sedimentary,2024-10-13,7.57,45.03,0.21,-0.012,30.15,0.093,0.037
Igneous,2024-12-05,44.97,17.89,0.45,0.015,20.12,0.152,0.021
Metamorphic,2021-07-09,17.85,13.03,0.6,0.043,10.68,0.273,0.022
Igneous,2023-06-09,48.28,5.96,0.27,0.026,12.44,0.276,0.019
Igneous,2024-08-06,18.56,65.35,0.66,-0.033,26.75,0.175,0.029
Metamorphic,2025-07-23,37.61,11.22,0.12,0.044,20.6,0.037,0.04
Metamorphic,2021-05-13,10.1,17.7,0.58,-0.014,27.38,0.168,0.004
Igneous,2020-12-08,1.87,37.1,0.44,0.042,35.63,0.299,0.001
Metamorphic,2025-03-25,8.97,40.84,0.51,-0.037,28.48,0.192,0.035
Sedimentary,2023-07-19,5.47,18.81,0.61,0.003,19.41,0.051,0.048
Metamorphic,2024-10-07,19.01,53.83,0.41,-0.034,22.5,0.132,0.031
Sedimentary,2021-04-15,18.92,5.01,0.28,-0.008,31.21,0.27,0.023
Metamorphic,2025-09-09,36.17,24.51,0.38,-0.003,13.17,0.131,0.043
Igneous,2023-06-19,25.49,54.12,0.3,-0.041,38.01,0.176,0.009
Metamorphic,2023-12-31,43.21,49.62,0.7,0.036,20.19,0.298,0.009
Sedimentary,2022-10-14,20.88,12.67,0.31,0.037,16.62,0.016,0.031
Sedimentary,2020-11-13,35.94,18.15,0.67,0.037,25.54,0.035,0.008
Igneous,2024-08-12,14.49,11.81,0.38,0.024,14.16,0.225,0.036
Sedimentary,2020-11-15,5.45,54.94,0.69,0.032,35.64,0.083,0.01
Metamorphic,2023-10-04,12.38,21.75,0.7,-0.049,37.28,0.165,0.029
Metamorphic,2020-12-27,27.51,26.49,0.23,-0.034,19.15,0.036,0.024
Igneous,2022-03-12,39.45,31.7,0.1,0.03,19.27,0.093,0.0
Sedimentary,2025-05-16,45.59,45.02,0.29,0.034,27.19,0.009,0.037
Igneous,2022-01-17,30.82,37.78,0.12,-0.033,12.3,0.011,0.009
Metamorphic,2021-07-10,29.24,21.65,0.57,-0.003,20.45,0.251,0.017
Igneous,2021-03-11,28.11,66.62,0.16,-0.037,16.93,0.177,0.029
Igneous,2023-10-23,5.57,39.92,0.23,-0.038,26.7,0.256,0.014
Igneous,2020-09-20,21.93,57.09,0.43,0.003,11.85,0.256,0.029
Igneous,2022-08-07,25.08,39.89,0.25,0.03,21.98,0.192,0.006
Metamorphic,2025-06-22,9.52,36.38,0.17,-0.02,15.63,0.202,0.004
Metamorphic,2023-08-14,22.2,57.05,0.37,0.049,26.72,0.065,0.045
Sedimentary,2021-04-08,3.5,60.57,0.47,0.031,15.11,0.238,0.013
Metamorphic,2020-12-23,31.63,55.79,0.67,-0.036,29.53,0.15,0.028
Sedimentary,2024-08-05,1.97,18.33,0.29,-0.034,35.78,0.271,0.002
Metamorphic,2023-06-21,13.04,57.3,0.31,-0.021,10.15,0.068,0.015
Igneous,2023-03-21,31.27,17.39,0.26,0.044,35.34,0.048,0.04
Sedimentary,2020-11-26,37.75,54.43,0.29,0.023,15.36,0.15,0.034
Igneous,2024-07-13,2.25,55.54,0.22,0.047,29.29,0.038,0.047
Metamorphic,2021-06-09,40.25,65.84,0.43,-0.024,19.17,0.011,0.035
Sedimentary,2020-11-16,22.08,35.85,0.69,-0.047,23.38,0.01,0.046
Igneous,2025-08-15,32.83,35.12,0.25,0.022,10.68,0.277,0.035
Sedimentary,2022-04-26,36.38,45.94,0.39,-0.034,15.78,0.072,0.049
Metamorphic,2023-09-30,25.78,6.46,0.14,-0.029,35.59,0.073,0.002
Sedimentary,2024-02-01,28.39,37.89,0.21,-0.026,33.41,0.108,0.039
Sedimentary,2025-03-10,3.34,46.89,0.33,-0.049,10.03,0.142,0.033
Sedimentary,2022-09-20,24.11,53.14,0.45,0.005,28.53,0.22,0.007
Igneous,2024-01-18,8.7,61.87,0.64,0.009,15.3,0.106,0.049
Igneous,2023-08-14,43.69,44.58,0.6,-0.031,30.82,0.084,0.026
Igneous,2024-08-04,7.7,55.51,0.12,-0.027,13.89,0.053,0.05
Metamorphic,2021-10-30,48.4,57.17,0.35,0.044,32.65,0.184,0.004
Sedimentary,2024-10-25,38.76,9.39,0.14,0.017,21.19,0.075,0.009
Sedimentary,2024-06-21,45.24,54.88,0.19,0.042,16.67,0.294,0.046
Igneous,2022-09-18,22.35,18.78,0.39,0.021,37.9,0.01,0.031
Metamorphic,2025-08-22,23.87,37.8,0.26,0.032,32.13,0.295,0.017
Igneous,2022-10-17,31.1,12.44,0.26,-0.049,28.71,0.132,0.014
Metamorphic,2023-05-30,30.52,50.21,0.52,-0.01,15.37,0.245,0.037
Metamorphic,2025-07-23,37.38,47.45,0.22,-0.021,17.34,0.244,0.022
Metamorphic,2025-04-30,16.2,51.17,0.22,-0.028,25.47,0.231,0.041
Sedimentary,2024-12-20,19.79,30.19,0.54,0.04,17.04,0.135,0.043
Metamorphic,2022-06-09,1.43,51.96,0.58,-0.014,26.81,0.235,0.047
Metamorphic,2025-04-02,17.91,64.15,0.11,0.0,34.49,0.228,0.005
Igneous,2022-10-31,15.52,49.59,0.38,-0.001,15.03,0.194,0.048
Metamorphic,2025-03-30,23.47,7.98,0.53,-0.033,31.95,0.083,0.012
Metamorphic,2021-05-09,26.21,27.22,0.63,0.046,37.26,0.291,0.049
Metamorphic,2023-03-13,13.83,25.73,0.36,0.01,34.35,0.19,0.033
Metamorphic,2022-12-09,43.91,17.9,0.3,0.049,38.97,0.053,0.032
Sedimentary,2021-05-01,13.08,17.69,0.46,-0.005,39.47,0.15,0.033
Igneous,2024-05-01,30.7,28.67,0.39,0.021,26.89,0.3,0.005
Igneous,2023-06-11,8.29,9.06,0.5,-0.037,27.63,0.076,0.013
Metamorphic,2025-01-25,40.32,36.27,0.7,-0.025,34.53,0.144,0.036
Metamorphic,2020-10-03,43.01,16.94,0.41,0.03,31.54,0.12,0.036
Sedimentary,2021-04-09,4.05,13.67,0.2,0.007,19.74,0.038,0.028
Sedimentary,2022-05-12,3.97,16.9,0.28,-0.032,12.56,0.206,0.035
Igneous,2021-12-17,45.79,45.98,0.67,0.012,28.59,0.069,0.011
Metamorphic,2025-04-18,0.72,18.82,0.32,0.023,21.45,0.157,0.036
Sedimentary,2024-03-14,0.66,68.32,0.14,-0.012,15.97,0.122,0.042
Sedimentary,2024-01-27,10.27,16.56,0.54,-0.032,33.65,0.247,0.024
Sedimentary,2025-02-15,38.69,38.61,0.54,0.006,10.51,0.124,0.018
Sedimentary,2023-07-31,18.76,40.06,0.58,0.011,22.53,0.235,0.03
Igneous,2022-12-13,42.82,24.93,0.2,-0.022,15.27,0.103,0.025
Metamorphic,2022-07-13,42.41,33.83,0.45,-0.036,34.04,0.11,0.011
Metamorphic,2021-07-13,1.47,6.68,0.27,-0.029,24.37,0.09,0.008
Sedimentary,2023-06-28,40.89,63.36,0.37,0.044,25.24,0.239,0.013
Sedimentary,2025-09-05,28.55,37.74,0.22,-0.004,24.67,0.22,0.005
Igneous,2024-07-30,46.9,24.81,0.52,0.035,30.87,0.104,0.017
Metamorphic,2023-06-25,49.52,61.12,0.21,0.014,37.72,0.182,0.009
Metamorphic,2021-08-08,29.28,53.99,0.61,0.041,34.71,0.291,0.002
Sedimentary,2023-08-20,1.33,51.83,0.62,-0.0,25.14,0.095,0.03
Metamorphic,2022-10-14,18.58,35.8,0.36,0.006,20.5,0.211,0.019
Metamorphic,2021-11-22,47.49,21.21,0.57,-0.031,29.99,0.222,0.029
Metamorphic,2022-03-14,18.97,34.08,0.14,0.039,14.91,0.246,0.046
Sedimentary,2022-06-20,15.67,16.81,0.59,0.015,29.26,0.199,0.022
Sedimentary,2025-02-16,13.46,25.98,0.62,-0.007,23.63,0.037,0.007
Sedimentary,2022-09-08,11.01,54.73,0.47,0.018,27.07,0.142,0.038
Igneous,2021-05-18,41.13,56.0,0.5,0.019,17.18,0.248,0.048
Igneous,2025-04-04,6.17,5.92,0.28,0.021,24.26,0.255,0.012
Sedimentary,2022-10-14,1.28,25.62,0.6,0.034,17.07,0.08,0.049
Sedimentary,2021-11-06,26.96,52.42,0.6,0.022,28.69,0.18,0.013
Metamorphic,2021-10-24,18.13,13.1,0.57,-0.029,15.23,0.241,0.024
Sedimentary,2022-11-05,12.15,58.29,0.65,0.044,23.01,0.055,0.009
Sedimentary,2023-09-26,43.02,15.91,0.27,-0.019,29.98,0.22,0.01
Sedimentary,2024-08-22,26.99,19.91,0.56,0.045,26.54,0.006,0.004
Igneous,2025-06-19,33.52,7.52,0.44,0.027,17.61,0.27,0.023
Igneous,2021-10-23,14.37,14.63,0.6,-0.025,20.31,0.092,0.043
Igneous,2023-01-27,48.48,34.35,0.36,0.024,31.61,0.295,0.018
Metamorphic,2020-12-27,49.86,42.14,0.16,0.017,27.73,0.158,0.015
Sedimentary,2022-10-18,11.56,52.64,0.61,-0.03,23.44,0.189,0.005
Igneous,2022-09-29,19.38,11.53,0.45,0.015,37.15,0.094,0.043
Igneous,2020-12-26,1.38,51.32,0.35,-0.01,15.73,0.176,0.032
Igneous,2021-05-08,31.95,29.34,0.69,-0.044,38.11,0.14,0.024
Igneous,2025-06-19,10.81,50.56,0.35,-0.023,27.33,0.085,0.029
Igneous,2022-12-20,13.36,63.66,0.32,-0.043,37.18,0.023,0.027
Metamorphic,2025-05-17,11.33,26.11,0.66,-0.037,25.26,0.019,0.018
Sedimentary,2021-04-18,7.67,22.16,0.54,0.004,17.52,0.186,0.02
Igneous,2022-01-29,12.14,45.94,0.26,0.021,31.19,0.105,0.03
Metamorphic,2025-02-09,0.9,8.72,0.38,0.013,27.55,0.106,0.045
Igneous,2022-07-09,39.85,28.07,0.42,0.02,24.5,0.297,0.01
Igneous,2023-11-11,24.92,16.98,0.45,0.012,26.31,0.253,0.044
Igneous,2024-02-01,41.5,64.81,0.22,-0.044,19.38,0.139,0.004
Sedimentary,2020-12-01,48.69,60.13,0.57,0.017,27.68,0.036,0.047
Sedimentary,2022-09-14,0.14,57.43,0.33,-0.044,38.35,0.285,0.044
Sedimentary,2023-07-28,5.68,23.48,0.42,0.036,24.32,0.22,0.026
Sedimentary,2024-05-16,15.76,44.57,0.24,0.014,30.19,0.163,0.017
Sedimentary,2021-12-10,33.6,20.73,0.51,0.04,17.59,0.2,0.035
Igneous,2021-08-31,6.92,52.9,0.22,0.045,18.42,0.133,0.015
Sedimentary,2023-01-06,1.2,54.38,0.61,0.047,38.59,0.29,0.024
Sedimentary,2021-09-28,41.01,29.96,0.42,-0.037,31.38,0.271,0.021
Sedimentary,2024-09-09,0.59,44.75,0.51,0.003,27.3,0.163,0.022
Sedimentary,2024-11-25,41.98,20.04,0.14,0.013,33.23,0.255,0.006
Sedimentary,2022-08-26,17.91,16.33,0.17,-0.04,38.24,0.186,0.042
Metamorphic,2023-07-31,11.0,39.1,0.2,0.044,13.49,0.042,0.045
Igneous,2022-07-04,17.84,12.06,0.45,-0.038,33.4,0.069,0.02
Igneous,2022-09-06,48.97,9.15,0.25,-0.006,29.32,0.224,0.006
Igneous,2025-05-21,26.78,22.87,0.14,0.012,19.9,0.272,0.015
Metamorphic,2021-06-01,1.91,19.04,0.34,-0.012,26.37,0.295,0.028
Metamorphic,2020-09-21,13.74,45.23,0.58,-0.023,18.96,0.165,0.003
Metamorphic,2022-01-29,42.7,50.61,0.45,-0.023,11.97,0.099,0.029
Igneous,2024-08-01,14.01,14.33,0.68,-0.031,28.25,0.205,0.041
Igneous,2024-02-10,10.23,35.25,0.15,-0.011,12.63,0.054,0.037
Sedimentary,2022-07-27,21.16,6.08,0.27,-0.008,34.99,0.016,0.005
Metamorphic,2024-03-11,28.5,39.47,0.34,0.026,39.42,0.163,0.04
Metamorphic,2025-01-26,40.82,56.95,0.37,-0.014,33.17,0.241,0.006
Sedimentary,2024-08-18,45.96,33.56,0.27,0.008,25.23,0.067,0.041
Metamorphic,2023-05-15,20.15,45.0,0.25,-0.039,29.71,0.071,0.036
Metamorphic,2021-08-21,32.34,17.67,0.36,0.048,28.8,0.119,0.002
Metamorphic,2025-05-17,0.56,39.25,0.37,0.002,20.14,0.285,0.016
Igneous,2022-05-09,34.03,27.24,0.54,0.002,15.28,0.178,0.007
Sedimentary,2023-10-09,37.37,15.81,0.54,0.02,39.01,0.139,0.048
Sedimentary,2023-07-18,11.26,17.66,0.62,0.047,25.96,0.074,0.006
Metamorphic,2023-03-17,9.38,16.22,0.44,-0.003,25.89,0.235,0.014
Igneous,2021-04-20,44.63,19.57,0.66,0.024,22.43,0.187,0.025
Igneous,2024-08-28,10.32,14.19,0.57,0.045,39.31,0.123,0.016
Metamorphic,2023-03-08,24.21,44.85,0.57,0.045,34.97,0.28,0.034
Igneous,2021-09-07,49.58,47.29,0.37,0.01,29.14,0.053,0.043
Metamorphic,2021-04-19,46.3,48.28,0.2,0.05,32.3,0.272,0.046
Sedimentary,2024-11-29,5.02,41.85,0.64,-0.046,38.19,0.145,0.015
Metamorphic,2021-03-27,20.2,22.44,0.44,-0.012,31.44,0.021,0.013
Metamorphic,2022-12-10,28.27,57.54,0.15,-0.008,31.14,0.17,0.024
Sedimentary,2024-09-11,27.02,12.22,0.26,-0.02,37.32,0.04,0.012
Igneous,2021-12-19,0.67,50.95,0.46,0.041,20.75,0.112,0.047
Igneous,2022-06-03,0.73,17.16,0.45,0.05,26.9,0.273,0.043
Igneous,2024-01-12,23.09,11.03,0.21,-0.006,20.35,0.137,0.022
Sedimentary,2024-03-09,43.29,30.9,0.23,-0.013,10.35,0.008,0.028
Igneous,2022-07-14,8.92,17.48,0.47,0.004,19.83,0.059,0.013
Sedimentary,2021-02-04,47.62,40.93,0.23,-0.04,12.44,0.02,0.04
Igneous,2022-09-13,22.48,38.29,0.31,0.022,25.46,0.08,0.046
Igneous,2025-06-22,30.08,62.25,0.54,0.002,15.95,0.112,0.015
Igneous,2023-04-13,25.11,7.78,0.54,-0.047,25.99,0.143,0.048
Igneous,2022-08-08,5.55,28.55,0.62,-0.027,26.75,0.196,0.039
Metamorphic,2021-09-28,23.18,24.78,0.23,-0.03,13.16,0.247,0.034
Metamorphic,2022-10-18,23.79,69.27,0.35,0.042,29.1,0.219,0.022
Igneous,2024-09-11,46.1,21.82,0.21,-0.016,23.38,0.235,0.011
Igneous,2024-03-19,28.19,8.3,0.36,-0.036,31.76,0.132,0.038
Sedimentary,2025-06-03,20.7,39.02,0.5,-0.001,14.25,0.13,0.034
Sedimentary,2024-05-07,12.27,11.68,0.53,-0.035,21.62,0.123,0.048
Sedimentary,2022-06-13,23.8,28.51,0.15,-0.01,33.72,0.225,0.03
Metamorphic,2023-09-28,29.52,13.88,0.15,0.031,31.91,0.159,0.003
Metamorphic,2021-03-22,47.11,22.75,0.24,0.049,18.03,0.155,0.004
Igneous,2021-02-17,22.2,27.38,0.35,0.045,18.99,0.139,0.003
Metamorphic,2023-11-26,18.44,21.25,0.44,0.046,12.62,0.165,0.014
Sedimentary,2024-04-27,5.35,15.93,0.37,-0.022,38.97,0.036,0.037
Metamorphic,2022-05-25,32.33,66.23,0.33,-0.002,31.6,0.0,0.002
Igneous,2022-01-28,34.74,65.38,0.52,-0.005,28.67,0.027,0.044
Sedimentary,2022-08-23,39.64,48.3,0.32,-0.027,21.05,0.108,0.039
Metamorphic,2024-04-25,32.05,51.38,0.3,0.017,15.57,0.21,0.035
Metamorphic,2024-01-16,14.35,52.17,0.47,0.016,34.21,0.154,0.037
Metamorphic,2024-03-17,3.1,32.01,0.61,-0.001,32.47,0.168,0.037
Sedimentary,2023-12-21,40.94,41.01,0.13,0.043,11.9,0.068,0.023
Sedimentary,2023-03-12,4.02,26.52,0.3,0.038,12.69,0.227,0.03
Metamorphic,2022-01-28,21.81,62.21,0.35,0.037,36.91,0.118,0.037
Metamorphic,2022-10-16,29.16,19.65,0.62,-0.01,35.82,0.023,0.002
Metamorphic,2025-02-19,39.56,37.06,0.64,-0.014,29.88,0.12,0.023
Sedimentary,2023-08-29,7.5,65.36,0.65,-0.009,20.76,0.066,0.02
Igneous,2024-01-23,30.48,23.99,0.43,-0.017,12.43,0.237,0.034
Sedimentary,2023-06-04,1.33,26.59,0.47,-0.015,26.34,0.123,0.03
Igneous,2022-11-18,40.34,28.75,0.63,0.006,20.11,0.167,0.018
Sedimentary,2025-04-08,44.64,44.66,0.35,-0.016,38.23,0.279,0.048
Sedimentary,2021-07-10,6.55,45.25,0.33,0.038,38.36,0.159,0.017
Sedimentary,2022-09-14,40.44,20.84,0.62,0.035,37.07,0.201,0.044
Metamorphic,2022-11-13,5.24,36.28,0.65,-0.022,38.32,0.088,0.026
Igneous,2022-03-03,41.91,60.71,0.31,0.021,39.38,0.105,0.007
Sedimentary,2024-05-06,43.81,38.77,0.25,-0.021,37.35,0.075,0.033
Igneous,2023-08-24,2.82,65.57,0.32,-0.022,26.91,0.252,0.022
Igneous,2021-10-02,32.5,28.69,0.69,0.003,32.18,0.193,0.009
Metamorphic,2021-04-12,44.31,54.04,0.32,-0.05,33.4,0.072,0.037
Sedimentary,2024-02-07,46.93,7.7,0.1,0.001,14.31,0.206,0.043
Igneous,2023-11-18,47.06,23.48,0.5,-0.024,28.18,0.208,0.047
Metamorphic,2023-10-13,21.01,46.23,0.16,-0.016,13.01,0.221,0.019
Sedimentary,2025-02-15,25.65,44.94,0.65,-0.033,21.91,0.072,0.048
Metamorphic,2021-05-24,12.2,9.05,0.5,0.042,29.76,0.215,0.014
Sedimentary,2021-07-31,15.23,25.0,0.69,0.043,27.1,0.092,0.016
Sedimentary,2024-04-05,30.62,52.07,0.48,0.019,29.19,0.042,0.03
Sedimentary,2023-09-30,0.65,17.12,0.4,-0.027,10.87,0.209,0.028
Metamorphic,2023-07-09,16.31,45.6,0.11,0.041,36.08,0.221,0.013
Metamorphic,2023-08-03,42.52,41.28,0.43,0.009,37.64,0.228,0.0
Metamorphic,2024-01-04,37.16,59.79,0.4,-0.012,23.29,0.2,0.011
Igneous,2023-08-13,36.29,46.74,0.67,-0.035,15.09,0.033,0.021
Sedimentary,2022-09-08,5.42,13.29,0.61,-0.028,26.44,0.105,0.041
Metamorphic,2022-06-29,25.52,60.41,0.18,-0.046,28.33,0.263,0.012
Igneous,2025-04-08,29.27,39.17,0.67,0.002,31.4,0.186,0.003
Igneous,2020-12-11,18.07,34.3,0.38,0.036,38.46,0.005,0.019
Igneous,2023-03-12,38.14,42.97,0.36,0.034,25.21,0.039,0.019
Sedimentary,2022-08-24,14.61,59.95,0.39,0.038,10.57,0.133,0.006
Sedimentary,2020-10-29,42.93,18.74,0.32,-0.002,25.52,0.283,0.042
Igneous,2024-12-01,5.89,9.32,0.32,-0.023,32.2,0.08,0.039
Igneous,2020-11-03,42.85,7.86,0.17,-0.025,17.97,0.167,0.022
Igneous,2025-09-12,41.02,17.52,0.24,-0.033,16.3,0.288,0.044
Metamorphic,2021-01-09,30.66,26.39,0.48,0.004,12.24,0.149,0.032
Sedimentary,2021-07-15,44.82,63.17,0.67,-0.012,26.73,0.034,0.04
Sedimentary,2023-10-30,21.98,18.41,0.69,-0.04,16.18,0.138,0.017
Igneous,2023-07-23,20.48,48.87,0.6,-0.018,18.49,0.031,0.039
Metamorphic,2021-04-15,31.83,39.28,0.11,-0.011,34.31,0.02,0.005
Igneous,2022-05-04,45.86,38.25,0.57,0.046,31.08,0.226,0.019
Sedimentary,2025-09-02,43.52,6.39,0.45,0.04,33.82,0.004,0.034
Igneous,2023-07-19,28.48,52.39,0.27,-0.031,20.85,0.12,0.045
Sedimentary,2021-10-25,48.65,49.56,0.68,-0.007,16.26,0.108,0.023
Igneous,2021-11-09,24.49,66.08,0.24,-0.037,28.37,0.149,0.016
Igneous,2023-10-11,2.47,32.39,0.62,0.038,38.67,0.106,0.016
Metamorphic,2022-06-03,36.76,16.74,0.7,-0.029,13.61,0.074,0.007
Sedimentary,2025-09-13,35.99,67.82,0.5,-0.027,11.03,0.015,0.046
Igneous,2022-06-01,20.82,52.13,0.29,-0.041,20.55,0.213,0.007
Sedimentary,2023-09-01,35.47,13.36,0.12,-0.029,18.4,0.072,0.033
Igneous,2023-01-09,5.01,17.47,0.26,0.028,14.77,0.037,0.014
Metamorphic,2024-09-02,49.67,39.75,0.66,0.011,17.94,0.285,0.011
Metamorphic,2025-04-05,38.86,28.4,0.47,-0.017,22.41,0.274,0.024
Igneous,2021-04-24,36.86,9.42,0.31,-0.014,15.38,0.035,0.033
Metamorphic,2023-03-28,45.22,31.12,0.17,0.015,31.84,0.064,0.015
Metamorphic,2020-10-22,38.35,60.08,0.7,0.048,38.4,0.165,0.048
Metamorphic,2024-03-31,43.21,31.92,0.34,0.05,32.12,0.017,0.015
Sedimentary,2022-05-11,32.58,45.15,0.25,0.044,27.81,0.0,0.04
Igneous,2020-11-14,47.43,43.72,0.63,-0.013,31.74,0.186,0.022
Sedimentary,2022-06-24,0.48,10.3,0.58,-0.029,22.37,0.133,0.025
Sedimentary,2020-10-17,17.47,43.16,0.15,0.01,29.07,0.147,0.039
Metamorphic,2024-05-14,31.72,42.56,0.32,0.033,10.66,0.136,0.018
Sedimentary,2025-07-05,21.92,24.87,0.52,-0.022,33.18,0.292,0.031
Metamorphic,2021-03-26,26.13,24.6,0.51,0.04,29.5,0.294,0.021
Sedimentary,2021-01-10,34.56,65.3,0.5,-0.014,22.56,0.038,0.026
Metamorphic,2022-02-05,20.0,24.4,0.53,-0.024,37.84,0.072,0.043
Sedimentary,2022-09-23,41.16,49.43,0.65,0.023,10.48,0.124,0.011
Metamorphic,2021-06-07,0.06,44.17,0.12,-0.037,21.82,0.015,0.026
Igneous,2021-04-04,9.59,24.06,0.58,-0.038,14.03,0.211,0.02
Igneous,2023-09-03,43.07,11.55,0.14,-0.024,15.88,0.188,0.003
Metamorphic,2021-02-27,29.15,28.78,0.32,0.005,21.84,0.236,0.034
Sedimentary,2023-06-26,48.23,60.47,0.21,0.007,39.94,0.02,0.01
Igneous,2024-01-23,46.45,5.84,0.61,0.05,35.13,0.091,0.037
Igneous,2025-09-10,6.81,18.92,0.45,-0.041,13.36,0.068,0.016
Igneous,2025-06-06,41.31,15.35,0.3,-0.05,14.82,0.034,0.036
Igneous,2024-07-20,8.61,50.3,0.57,-0.01,25.11,0.219,0.025
Metamorphic,2024-04-08,22.98,55.03,0.34,-0.038,33.89,0.198,0.03
Sedimentary,2022-09-29,22.76,65.0,0.56,0.041,27.03,0.218,0.003
Igneous,2022-08-04,3.61,59.33,0.36,0.01,36.23,0.254,0.029
Igneous,2025-09-02,48.78,25.77,0.45,0.024,23.28,0.019,0.012
Metamorphic,2022-04-09,34.78,10.23,0.14,0.029,22.32,0.231,0.023
Igneous,2020-12-18,34.69,37.65,0.59,-0.035,18.85,0.081,0.005
Igneous,2022-09-28,46.57,65.04,0.49,-0.041,22.84,0.218,0.013
Sedimentary,2021-09-12,32.14,35.25,0.68,-0.02,19.28,0.134,0.04
Igneous,2025-03-13,21.49,65.1,0.62,0.029,14.21,0.056,0.004
Sedimentary,2023-05-21,9.92,17.16,0.7,-0.03,14.39,0.295,0.032
Igneous,2021-05-05,24.66,51.71,0.25,-0.02,23.14,0.213,0.0
Igneous,2021-07-09,26.33,67.2,0.22,0.013,30.24,0.211,0.009
Sedimentary,2023-06-13,47.96,28.98,0.29,0.042,39.05,0.066,0.011
Sedimentary,2023-04-29,39.94,69.0,0.58,-0.028,23.44,0.244,0.025
Igneous,2022-05-11,2.94,39.07,0.37,0.049,35.5,0.227,0.036
Sedimentary,2021-07-09,0.11,45.16,0.34,0.025,13.82,0.13,0.005
Igneous,2024-02-13,32.43,59.6,0.45,-0.012,19.45,0.254,0.038
Sedimentary,2023-11-20,42.02,35.11,0.26,-0.002,29.11,0.004,0.017
Metamorphic,2024-05-04,4.07,29.66,0.47,-0.042,12.45,0.154,0.05
Igneous,2024-09-18,6.65,65.41,0.38,-0.042,14.84,0.006,0.026
Sedimentary,2024-02-18,46.18,30.39,0.12,-0.011,28.7,0.141,0.028
Igneous,2023-07-26,29.97,34.43,0.24,-0.036,26.55,0.091,0.035
Sedimentary,2021-06-15,21.33,36.26,0.2,0.016,10.46,0.19,0.043
Igneous,2023-12-12,0.61,36.19,0.34,-0.047,34.83,0.211,0.05
Sedimentary,2023-08-04,35.77,53.16,0.29,-0.039,27.91,0.114,0.044
Metamorphic,2021-10-06,34.39,28.7,0.45,0.047,25.55,0.007,0.019
Igneous,2025-08-15,48.37,17.98,0.55,0.019,28.82,0.284,0.013
Metamorphic,2021-05-15,5.15,10.57,0.56,0.021,29.18,0.031,0.034
Metamorphic,2025-07-09,43.22,48.25,0.36,-0.028,16.54,0.201,0.031
Sedimentary,2022-12-16,19.24,18.63,0.57,-0.017,34.72,0.209,0.048
Metamorphic,2021-08-12,18.89,62.41,0.49,0.041,21.6,0.285,0.034
Metamorphic,2023-06-19,39.5,49.04,0.11,-0.022,34.13,0.042,0.038
Sedimentary,2024-08-03,47.86,10.16,0.37,0.025,23.06,0.242,0.028
Sedimentary,2022-12-09,20.33,43.11,0.31,-0.044,23.54,0.037,0.042
Metamorphic,2021-12-18,9.49,68.12,0.45,0.048,18.62,0.239,0.037
Sedimentary,2022-10-27,10.51,52.58,0.29,-0.014,23.56,0.132,0.011
Sedimentary,2024-08-31,24.41,37.75,0.28,-0.023,30.4,0.24,0.016
Igneous,2023-08-15,28.89,43.61,0.58,-0.047,29.9,0.241,0.043
Metamorphic,2022-01-16,12.25,58.95,0.5,0.017,19.43,0.177,0.02
Igneous,2022-06-06,4.65,14.3,0.44,0.02,20.19,0.181,0.04
Igneous,2024-12-13,38.41,51.29,0.64,-0.002,29.2,0.139,0.022
Metamorphic,2022-02-06,44.63,58.88,0.2,-0.023,12.72,0.053,0.027
Sedimentary,2021-12-07,29.26,60.48,0.43,-0.012,36.25,0.118,0.019
Igneous,2025-03-28,27.66,10.86,0.59,-0.029,24.24,0.117,0.029
Metamorphic,2022-12-19,27.85,69.26,0.22,0.01,28.01,0.121,0.033
Metamorphic,2021-05-01,30.03,39.55,0.11,-0.029,19.74,0.186,0.027
Sedimentary,2024-05-29,40.39,37.83,0.32,-0.043,15.55,0.132,0.024
Metamorphic,2021-11-01,7.32,13.18,0.41,0.034,34.4,0.077,0.004
Igneous,2022-12-05,18.72,7.79,0.4,0.034,31.16,0.182,0.028
Metamorphic,2021-03-22,7.41,62.14,0.59,0.046,10.59,0.053,0.048
Sedimentary,2022-01-21,37.77,64.3,0.65,-0.036,18.14,0.232,0.03
Metamorphic,2024-12-29,35.35,52.78,0.14,0.044,34.37,0.259,0.032
Sedimentary,2021-12-31,2.03,62.42,0.61,-0.006,13.24,0.024,0.03
Igneous,2022-05-12,40.49,55.57,0.28,-0.03,38.25,0.293,0.037
Sedimentary,2021-08-17,12.51,32.67,0.27,-0.04,28.39,0.212,0.019
Sedimentary,2024-11-14,36.58,62.67,0.58,-0.032,34.95,0.077,0.05
Sedimentary,2022-12-29,18.73,54.67,0.15,0.049,22.93,0.206,0.011
Igneous,2024-06-23,14.19,64.35,0.68,-0.0,39.46,0.189,0.032
Metamorphic,2024-11-27,46.43,65.85,0.53,-0.005,39.35,0.019,0.044
Metamorphic,2024-10-28,17.84,11.25,0.52,-0.017,33.48,0.003,0.014
Metamorphic,2023-08-31,10.57,45.38,0.44,0.041,25.4,0.134,0.048
Sedimentary,2023-05-22,21.02,68.95,0.24,0.018,18.79,0.073,0.04
Igneous,2020-11-26,19.55,21.03,0.22,0.049,20.45,0.112,0.04
Sedimentary,2021-03-01,9.41,29.09,0.63,0.03,20.97,0.206,0.038
Sedimentary,2021-12-04,48.95,30.7,0.29,-0.002,16.8,0.097,0.013
Metamorphic,2021-06-01,44.0,18.53,0.15,0.028,21.05,0.206,0.017
Metamorphic,2021-03-08,42.42,21.95,0.45,0.023,24.75,0.106,0.012
Sedimentary,2022-02-10,37.43,42.36,0.55,0.002,21.48,0.011,0.013
Metamorphic,2022-05-12,4.64,28.45,0.41,0.004,10.35,0.25,0.02
Sedimentary,2021-05-26,9.51,46.06,0.33,0.042,39.62,0.03,0.031
Metamorphic,2020-11-25,36.82,30.7,0.14,-0.032,10.55,0.169,0.01
Metamorphic,2023-02-07,33.12,41.59,0.23,0.02,35.88,0.034,0.024
Metamorphic,2021-11-13,6.18,59.04,0.21,-0.033,35.63,0.295,0.03
Metamorphic,2025-07-18,7.07,22.67,0.49,0.013,37.48,0.225,0.027
Igneous,2024-04-01,32.64,36.58,0.31,0.013,13.35,0.002,0.016
Metamorphic,2022-01-19,39.18,69.07,0.38,0.003,28.55,0.072,0.03
Metamorphic,2022-02-19,25.2,54.32,0.65,0.028,34.99,0.274,0.049
Igneous,2022-10-16,40.15,65.28,0.64,-0.049,31.38,0.07,0.043
Sedimentary,2021-04-13,37.2,29.86,0.25,-0.049,15.65,0.21,0.031
Metamorphic,2021-04-22,0.5,7.46,0.27,-0.022,38.96,0.207,0.035
Metamorphic,2025-07-26,22.74,40.04,0.15,0.039,17.26,0.0,0.006
Igneous,2024-02-02,47.74,45.37,0.13,-0.004,27.58,0.258,0.012
Metamorphic,2021-01-28,0.34,59.5,0.33,-0.028,25.82,0.046,0.018
Sedimentary,2023-11-11,16.49,35.85,0.24,-0.041,18.02,0.008,0.005
Igneous,2024-03-29,31.24,27.29,0.47,-0.011,30.26,0.294,0.038
Metamorphic,2024-11-23,26.04,49.25,0.65,0.001,18.3,0.156,0.037
Igneous,2025-08-05,26.81,32.86,0.37,-0.031,12.47,0.133,0.006
Igneous,2024-11-20,29.71,7.84,0.36,-0.021,15.18,0.011,0.025
Metamorphic,2021-12-17,1.8,13.33,0.14,0.003,11.21,0.064,0.006
Igneous,2022-01-27,36.64,14.26,0.28,-0.033,12.43,0.246,0.04
Igneous,2023-07-16,22.42,65.16,0.45,-0.043,36.4,0.254,0.032
Igneous,2025-07-24,10.02,23.01,0.57,0.037,24.67,0.161,0.018
Sedimentary,2023-04-06,27.04,29.87,0.49,-0.045,22.12,0.216,0.043
Sedimentary,2021-06-20,41.68,43.11,0.4,-0.043,16.57,0.011,0.04
Sedimentary,2022-07-12,43.74,60.97,0.34,0.048,17.08,0.068,0.024
Metamorphic,2024-11-28,0.21,7.9,0.68,0.023,25.98,0.279,0.02
Metamorphic,2025-04-25,41.43,68.44,0.22,0.006,20.02,0.099,0.023
Metamorphic,2024-05-23,24.09,41.44,0.64,0.007,15.32,0.056,0.044
Sedimentary,2022-06-11,45.89,24.67,0.3,-0.0,38.31,0.129,0.018
Igneous,2022-02-03,28.76,32.15,0.62,0.001,15.04,0.17,0.006
Igneous,2021-10-14,19.65,21.3,0.28,-0.041,16.81,0.143,0.018
Igneous,2023-05-21,30.83,25.38,0.59,-0.004,37.71,0.147,0.033
Igneous,2024-12-13,16.93,55.43,0.35,-0.027,18.15,0.192,0.036
Sedimentary,2023-03-05,17.69,67.56,0.38,-0.008,24.33,0.298,0.04
Sedimentary,2022-03-15,23.91,34.03,0.29,0.015,21.28,0.299,0.026
Igneous,2022-03-15,22.59,44.53,0.59,-0.001,10.98,0.11,0.027
Sedimentary,2023-01-22,20.25,37.86,0.31,0.041,22.11,0.108,0.027
Metamorphic,2022-12-27,23.97,63.68,0.5,-0.029,22.72,0.24,0.02
Sedimentary,2022-09-16,11.92,19.32,0.67,0.02,17.57,0.054,0.032
Igneous,2021-07-17,45.87,62.77,0.15,-0.033,35.17,0.259,0.045
Igneous,2022-12-30,43.53,59.74,0.48,0.004,34.31,0.04,0.009
Igneous,2021-10-13,29.4,41.51,0.41,-0.038,30.98,0.155,0.026
Igneous,2025-08-17,39.55,22.99,0.53,0.006,19.99,0.201,0.01
Metamorphic,2021-10-15,23.83,55.19,0.39,0.014,21.23,0.025,0.038
Metamorphic,2020-10-13,8.82,24.84,0.56,0.044,26.6,0.296,0.009
Sedimentary,2021-09-13,25.84,51.6,0.17,0.005,11.29,0.177,0.037
Igneous,2025-06-17,48.03,11.73,0.25,-0.024,15.68,0.166,0.04
Sedimentary,2024-12-11,24.84,63.24,0.27,-0.049,15.88,0.223,0.045
Sedimentary,2024-09-17,5.06,68.72,0.59,-0.027,26.17,0.006,0.003
Sedimentary,2021-02-23,41.01,67.16,0.44,-0.044,12.05,0.298,0.043
Sedimentary,2025-03-09,20.67,5.39,0.5,-0.039,27.07,0.157,0.034
Igneous,2020-12-10,24.63,9.77,0.66,0.006,10.59,0.133,0.042
Metamorphic,2020-11-04,45.33,43.05,0.34,0.032,35.59,0.005,0.003
Metamorphic,2023-01-31,5.11,57.55,0.68,-0.002,10.82,0.142,0.009
Sedimentary,2024-07-28,26.23,14.37,0.21,-0.022,10.73,0.159,0.0
Metamorphic,2024-06-20,5.56,26.09,0.5,0.033,25.9,0.199,0.049
Sedimentary,2022-12-04,48.48,55.66,0.7,0.014,32.81,0.295,0.037
Igneous,2022-08-23,24.63,68.89,0.13,-0.035,26.08,0.058,0.041
Metamorphic,2023-01-01,14.12,17.57,0.24,-0.045,33.86,0.239,0.001
Igneous,2023-02-14,10.34,67.26,0.34,0.044,30.5,0.269,0.047
Metamorphic,2024-07-16,10.91,60.86,0.44,0.023,31.82,0.142,0.029
Metamorphic,2025-03-26,4.22,66.64,0.49,0.006,22.53,0.069,0.012
Metamorphic,2024-11-15,5.74,17.18,0.5,-0.009,20.83,0.117,0.007
Metamorphic,2024-05-31,0.77,64.15,0.61,-0.042,26.74,0.049,0.042
Sedimentary,2024-09-03,38.1,24.07,0.33,0.029,27.93,0.236,0.016
Sedimentary,2025-08-17,48.4,63.47,0.24,-0.046,16.45,0.286,0.004
Metamorphic,2022-10-07,25.45,55.84,0.34,0.004,21.15,0.047,0.047
Sedimentary,2022-01-20,3.56,49.88,0.55,0.005,21.14,0.16,0.023
Metamorphic,2024-11-02,38.67,35.58,0.12,-0.011,14.62,0.177,0.001
Igneous,2025-09-14,40.72,38.52,0.44,-0.015,34.78,0.121,0.036
Metamorphic,2025-02-23,19.48,55.21,0.38,-0.024,25.82,0.061,0.027
Sedimentary,2024-12-12,0.17,68.07,0.42,0.033,10.02,0.157,0.0
Sedimentary,2023-10-28,27.28,57.2,0.63,0.029,29.06,0.271,0.027
Metamorphic,2021-03-31,28.04,44.9,0.3,0.027,27.17,0.26,0.019
Igneous,2024-04-06,8.29,9.14,0.53,-0.014,12.05,0.296,0.002
Metamorphic,2020-10-15,8.26,29.11,0.59,0.022,30.84,0.184,0.031
Metamorphic,2021-06-06,4.68,17.54,0.46,-0.044,14.94,0.114,0.014
Metamorphic,2021-11-15,32.55,5.52,0.35,-0.018,37.76,0.227,0.008
Igneous,2024-03-03,49.79,21.58,0.45,0.011,35.74,0.138,0.039
Igneous,2024-10-19,1.52,59.77,0.46,-0.02,27.81,0.064,0.031
Metamorphic,2020-10-04,26.69,36.65,0.38,-0.027,37.97,0.227,0.038
Metamorphic,2022-01-13,2.72,54.94,0.12,0.026,37.9,0.263,0.04
Igneous,2023-01-27,28.02,50.97,0.17,0.009,28.34,0.159,0.045
Sedimentary,2023-05-20,1.83,12.53,0.62,0.003,35.87,0.083,0.046
Metamorphic,2023-05-01,43.72,16.53,0.2,-0.05,11.21,0.257,0.022
Metamorphic,2023-01-09,16.78,25.58,0.15,0.013,26.38,0.196,0.02
Sedimentary,2021-04-16,7.85,40.86,0.44,0.007,11.88,0.265,0.029
Sedimentary,2022-07-21,31.66,44.77,0.44,-0.019,12.87,0.012,0.003
Sedimentary,2023-06-05,20.96,42.07,0.33,0.0,20.34,0.253,0.038
Metamorphic,2022-12-29,1.0,6.09,0.19,-0.006,12.27,0.193,0.029
Igneous,2021-04-15,49.64,58.82,0.12,0.044,20.65,0.095,0.045
Sedimentary,2021-03-20,15.44,24.45,0.49,0.042,29.45,0.263,0.036
Metamorphic,2021-09-14,35.46,16.18,0.59,-0.027,32.36,0.195,0.03
Igneous,2024-04-10,0.87,48.44,0.61,-0.045,23.44,0.142,0.023
Igneous,2021-10-27,43.07,69.33,0.67,0.047,28.45,0.276,0.041
Sedimentary,2023-03-17,26.36,28.58,0.36,0.003,39.51,0.203,0.048
Sedimentary,2021-11-13,3.51,34.25,0.37,0.021,30.42,0.096,0.049
Igneous,2021-06-13,15.89,40.71,0.47,-0.015,20.02,0.094,0.047
Igneous,2023-01-08,14.88,12.46,0.57,0.024,32.11,0.256,0.044
Sedimentary,2021-01-05,23.51,7.07,0.58,0.022,34.02,0.072,0.04
Igneous,2024-04-15,37.78,57.66,0.22,-0.004,38.11,0.168,0.037
Sedimentary,2025-05-01,49.25,12.71,0.62,0.028,39.5,0.082,0.007
Igneous,2022-04-22,3.75,64.63,0.2,-0.035,23.45,0.271,0.008
Sedimentary,2022-04-22,32.47,24.35,0.49,-0.001,19.07,0.145,0.028
Sedimentary,2024-04-06,24.55,40.14,0.3,0.037,19.68,0.109,0.029
Metamorphic,2022-12-03,15.2,5.87,0.47,-0.029,37.48,0.218,0.015
Metamorphic,2023-01-26,21.53,20.71,0.13,0.035,18.83,0.058,0.023
Metamorphic,2021-02-19,19.73,6.72,0.48,-0.018,36.76,0.167,0.017
Sedimentary,2023-10-02,11.22,64.35,0.13,0.001,38.09,0.237,0.023
Sedimentary,2024-10-16,29.49,36.41,0.6,0.027,36.97,0.201,0.021
Metamorphic,2025-02-24,12.83,46.29,0.41,0.05,33.05,0.035,0.001
Sedimentary,2023-10-02,45.03,5.84,0.42,-0.035,20.68,0.033,0.045
Metamorphic,2024-03-07,21.67,49.21,0.64,0.021,29.04,0.175,0.011
Sedimentary,2021-12-14,13.94,22.8,0.37,-0.025,32.03,0.071,0.035
Igneous,2025-07-26,30.09,36.99,0.37,0.036,17.37,0.256,0.048
Sedimentary,2023-08-10,8.09,67.29,0.2,-0.04,15.87,0.239,0.025
Igneous,2024-01-21,45.02,13.28,0.32,-0.029,17.33,0.131,0.04
Metamorphic,2023-03-31,18.76,57.74,0.35,0.034,15.48,0.066,0.045
Metamorphic,2021-12-04,38.08,35.96,0.45,0.039,17.46,0.095,0.003
Sedimentary,2024-08-17,4.64,17.16,0.57,0.026,22.82,0.11,0.006
Sedimentary,2021-10-25,23.83,26.04,0.39,0.036,14.22,0.259,0.013
Igneous,2025-02-24,9.59,25.2,0.26,-0.044,29.65,0.124,0.04
Metamorphic,2022-05-08,42.77,27.36,0.33,0.029,23.3,0.143,0.045
Metamorphic,2020-11-18,0.45,10.6,0.63,-0.036,18.59,0.144,0.036
Igneous,2025-07-17,33.82,55.8,0.21,0.014,12.52,0.085,0.015
Igneous,2025-08-14,0.04,15.32,0.41,-0.009,28.63,0.292,0.021
Metamorphic,2023-08-20,14.13,15.86,0.13,-0.041,35.72,0.253,0.015
Sedimentary,2022-11-06,37.85,15.02,0.63,0.048,30.78,0.077,0.04
Igneous,2024-10-25,33.77,59.34,0.52,-0.021,11.96,0.287,0.046
Sedimentary,2025-08-19,19.83,39.42,0.45,0.041,35.18,0.259,0.021
Sedimentary,2022-04-30,16.1,43.71,0.42,-0.038,27.17,0.083,0.02
Igneous,2024-03-20,27.98,37.49,0.64,0.036,17.49,0.13,0.013
Igneous,2025-03-19,22.18,8.27,0.5,-0.047,14.42,0.225,0.003
Metamorphic,2021-12-30,2.05,65.43,0.4,-0.026,10.06,0.265,0.032
Metamorphic,2025-03-20,38.18,5.43,0.53,-0.021,17.81,0.191,0.021
Igneous,2025-03-02,45.09,43.28,0.57,0.028,36.09,0.196,0.029
Metamorphic,2024-05-08,1.44,64.49,0.42,-0.03,39.93,0.172,0.012
Metamorphic,2023-01-26,19.04,40.62,0.63,-0.003,38.8,0.08,0.048
Metamorphic,2025-04-02,22.19,22.92,0.25,-0.044,17.54,0.138,0.037
Metamorphic,2024-01-26,37.44,13.52,0.11,-0.019,28.22,0.214,0.015
Igneous,2022-05-13,40.89,37.63,0.43,0.043,38.2,0.003,0.041
Metamorphic,2024-01-20,16.69,42.55,0.2,0.019,33.58,0.13,0.039
Metamorphic,2025-09-17,1.96,49.93,0.58,-0.049,17.76,0.226,0.022
Metamorphic,2022-01-09,25.56,57.01,0.65,0.044,17.69,0.17,0.01
Sedimentary,2023-06-12,30.39,50.85,0.22,0.023,28.09,0.155,0.001
Igneous,2025-06-01,14.33,36.8,0.37,-0.03,37.48,0.129,0.012
Igneous,2025-03-10,22.25,40.68,0.17,0.024,39.36,0.21,0.009
Igneous,2021-02-09,30.23,13.87,0.37,-0.042,25.62,0.058,0.0
Igneous,2025-02-27,39.28,42.09,0.65,-0.011,20.21,0.192,0.027
Igneous,2024-12-31,41.41,22.55,0.6,0.043,32.73,0.205,0.041
Sedimentary,2023-06-03,5.73,57.27,0.51,0.019,15.21,0.028,0.028
Metamorphic,2024-04-24,37.21,26.21,0.54,-0.034,20.53,0.183,0.034
Metamorphic,2024-10-29,10.63,66.38,0.61,-0.008,23.76,0.204,0.006
Sedimentary,2023-09-04,3.3,24.62,0.34,-0.007,15.64,0.116,0.009
Sedimentary,2025-08-25,16.57,47.46,0.37,-0.027,25.04,0.026,0.029
Igneous,2024-06-09,2.48,14.16,0.26,-0.031,19.91,0.091,0.003
Igneous,2021-05-10,30.88,36.0,0.37,-0.048,33.6,0.195,0.018
Metamorphic,2022-11-08,18.15,5.66,0.59,-0.003,32.82,0.171,0.009
Igneous,2021-11-01,32.75,42.57,0.39,-0.045,37.59,0.284,0.033
"""

# Load the data
df = pd.read_csv(io.StringIO(csv_data))

# Drop the 'Date' column for this initial model, as it's not directly used as a feature
df = df.drop('Date', axis=1)

# Function to simulate Factor of Safety (a simple physics-based model)
# This is a placeholder for a more complex LEM or other geotechnical model
def calculate_factor_of_safety(row):
    # Basic LEM-like logic: Higher slope angle, rainfall, certain rock types reduce FS
    # Higher cohesion/friction (inferred from rock type) increase FS
    fs = 2.5 # Start with a generally stable FS

    # Adjust based on slope angle
    if row['Slope_Angle'] > 45: fs -= 0.8
    elif row['Slope_Angle'] > 30: fs -= 0.4
    elif row['Slope_Angle'] > 15: fs -= 0.1

    # Adjust based on rainfall
    if row['Rainfall'] > 40: fs -= 0.6
    elif row['Rainfall'] > 20: fs -= 0.3

    # Adjust based on rock type (simulating material properties)
    if row['Rock_Type'] == 'Sedimentary': fs -= 0.5
    elif row['Rock_Type'] == 'Metamorphic': fs -= 0.2
    # Igneous might be more stable, so no reduction

    # Adjust based on Change_in_NDVI (vegetation loss -> less stability)
    if row['Change_in_NDVI'] < -0.03: fs -= 0.3

    # Adjust based on Soil_Moisture (high moisture -> less stability)
    if row['Soil_Moisture'] > 35: fs -= 0.3

    # Adjust based on vibrations
    if row['Blast_Vibration'] > 0.2: fs -= 0.4
    if row['Seismic_Vibration'] > 0.03: fs -= 0.2
    
    return max(0.5, round(fs, 2)) # Ensure FS doesn't go too low, min 0.5

# Calculate Factor of Safety using the simulated physics model
df['Factor_of_Safety'] = df.apply(calculate_factor_of_safety, axis=1)

# Define synthetic 'rockfall_probability' and 'time_to_impact' based on FS
def assign_probability_and_time(row):
    fs = row['Factor_of_Safety']
    
    # Higher probability for lower FS
    probability = min(1.0, max(0.0, 1.5 - (fs * 0.5))) # Scales FS > 1 to lower probability, FS < 1 to higher
    
    # Assign time to impact: lower FS -> shorter time
    if fs < 0.8: time_to_impact = np.random.uniform(1, 12) # 1-12 hours
    elif fs < 1.2: time_to_impact = np.random.uniform(12, 72) # 12-72 hours
    elif fs < 1.8: time_to_impact = np.random.uniform(72, 336) # 3-14 days (72-336 hours)
    else: time_to_impact = np.random.uniform(336, 1440) # 14-60 days (336-1440 hours)

    return pd.Series({'rockfall_probability': round(probability, 2), 'time_to_impact': round(time_to_impact, 2)})

# Apply the new target variable generation
df = pd.concat([df, df.apply(assign_probability_and_time, axis=1)], axis=1)

# Define features (X) and new targets (y_prob, y_time)
X = df.drop(['rockfall_probability', 'time_to_impact'], axis=1)
y_prob = df['rockfall_probability']
y_time = df['time_to_impact']

# Identify categorical and numerical features (Factor_of_Safety is numerical)
categorical_features = ['Rock_Type']
numerical_features = X.select_dtypes(include=['float64', 'int64']).columns.tolist()
numerical_features = [f for f in numerical_features if f not in categorical_features] # Ensure no overlap

# Create preprocessing pipelines for numerical and categorical features
numerical_transformer = StandardScaler()
categorical_transformer = OneHotEncoder(handle_unknown='ignore')

# Create a column transformer to apply different transformations to different columns
preprocessor = ColumnTransformer(
    transformers=[
        ('num', numerical_transformer, numerical_features),
        ('cat', categorical_transformer, categorical_features)
    ])

# Create pipelines for probability and time to impact regressors
probability_pipeline = Pipeline(steps=[('preprocessor', preprocessor),
                                        ('regressor', RandomForestRegressor(random_state=42))])

time_to_impact_pipeline = Pipeline(steps=[('preprocessor', preprocessor),
                                           ('regressor', RandomForestRegressor(random_state=42))])

# Split data into training and testing sets
# Split for probability model
X_train_prob, X_test_prob, y_train_prob, y_test_prob = train_test_split(X, y_prob, test_size=0.2, random_state=42)
# Split for time to impact model (can reuse X splits, but y is different)
X_train_time, X_test_time, y_train_time, y_test_time = train_test_split(X, y_time, test_size=0.2, random_state=42)

# Train the models
print("Training Probability Model...")
probability_pipeline.fit(X_train_prob, y_train_prob)
print("Training Time to Impact Model...")
time_to_impact_pipeline.fit(X_train_time, y_train_time)

# Evaluate the models
print("\nProbability Model Evaluation:")
y_pred_prob = probability_pipeline.predict(X_test_prob)
print(f"Mean Squared Error: {mean_squared_error(y_test_prob, y_pred_prob):.2f}")
print(f"R2 Score: {r2_score(y_test_prob, y_pred_prob):.2f}")

print("\nTime to Impact Model Evaluation:")
y_pred_time = time_to_impact_pipeline.predict(X_test_time)
print(f"Mean Squared Error: {mean_squared_error(y_test_time, y_pred_time):.2f}")
print(f"R2 Score: {r2_score(y_test_time, y_pred_time):.2f}")

# Save the trained pipelines and feature names
joblib.dump(probability_pipeline, 'ml_service/rockfall_probability_pipeline.joblib')
joblib.dump(time_to_impact_pipeline, 'ml_service/rockfall_time_to_impact_pipeline.joblib')
joblib.dump(X_train_prob.columns.tolist(), 'ml_service/model_features.joblib')

print("\nModel training complete and saved as rockfall_probability_pipeline.joblib, rockfall_time_to_impact_pipeline.joblib")
print("Feature names saved as model_features.joblib")
